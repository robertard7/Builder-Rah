{
  "id": "task.tools.env_aware_preflight_bundle.v1",
  "kind": "atom",
  "version": 1,
  "meta": { "visibility": "internal", "priority": 7 },
  "title": "Tools: env-aware preflight bundle",
  "description": "High-level atom that expresses the preflight sequence: detect env -> constrain capabilities -> WAIT_USER if blocked -> apply selection.",
  "tags": ["tools", "env", "preflight", "bundle", "internal"],
  "updatedUtc": "2025-12-28T00:00:00Z",
  "content": {
    "action": "composite",
    "steps": [
      { "use": "task.env.detect_runtime_and_constraints.v1" },
      { "use": "task.tools.apply_env_constraints_to_capabilities.v1" },
      {
        "when": "waitUser == true",
        "use": "task.tools.wait_user.select_execution_environment.v1"
      },
      {
        "when": "userSelection exists",
        "use": "task.tools.map_env_choice_to_execution_target.v1"
      }
    ],
    "outputs": ["executionTarget", "capabilityRefsConstrained", "runtimeProfile", "constraints"]
  }
}
